# ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è –ª–æ–±–±–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π

## üìã –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### Backend:

1. **MatchLobbyService.js** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:
   - `isLobbyExpired(lobby)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è (> 1 —á–∞—Å)
   - `getUserActiveLobbyInTournament(userId, tournamentId)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `resendLobbyInvitations(lobbyId, io)` - –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π

2. **MatchLobbyController.js** - –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:
   - `resendLobbyInvitations` - endpoint –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
   - `getUserActiveLobby` - endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏
   - –û–±–Ω–æ–≤–ª–µ–Ω `getLobbyInfo` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 410 —Å—Ç–∞—Ç—É—Å –¥–ª—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ª–æ–±–±–∏

3. **Routes (backend/routes/tournament/index.js)** - –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ä–æ—É—Ç—ã:
   - `POST /api/tournaments/:tournamentId/lobby/:lobbyId/resend-invites`
   - `GET /api/tournaments/:tournamentId/my-active-lobby`

### Frontend:

1. **useTournamentLobby.js** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ 410 —Å—Ç–∞—Ç—É—Å–∞ (–ª–æ–±–±–∏ —É—Å—Ç–∞—Ä–µ–ª–æ)

2. **ActiveLobbyWidget.js** - –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–¥–∂–µ—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏:
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–Ω–Ω–µ—Ä –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–µ –ª–æ–±–±–∏
   - –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –ª–æ–±–±–∏
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ª–æ–±–±–∏

3. **TournamentAdminPanel.js** - –¥–æ–±–∞–≤–ª–µ–Ω –±–ª–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ–±–±–∏:
   - –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ–±–±–∏ —Å –∫–Ω–æ–ø–∫–æ–π "–ü–µ—Ä–µ—Å–ª–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è"
   - –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å –≤—Ä—É—á–Ω—É—é

### –í —Ñ–∞–π–ª–µ `frontend/src/components/TournamentDetails.js`:

1. –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (–ø–æ—Å–ª–µ `handleCreateMatchLobby`):

```javascript
// üì® –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π –≤ –ª–æ–±–±–∏
const handleResendLobbyInvites = useCallback(async (lobbyId) => {
    try {
        setLoading(true);
        const token = localStorage.getItem('token');
        
        if (!token) {
            throw new Error('–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏');
        }
        
        console.log('üì® –ü–µ—Ä–µ—Å—ã–ª–∞–µ–º –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –ª–æ–±–±–∏:', lobbyId);
        
        const response = await api.post(
            `/api/tournaments/${id}/lobby/${lobbyId}/resend-invites`,
            {},
            {
                headers: { 
                    Authorization: `Bearer ${token}`,
                    'Content-Type': 'application/json'
                }
            }
        );
        
        console.log('‚úÖ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã:', response.data);
        
        setMessage(response.data.message || '–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!');
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π:', error);
        
        let errorMessage = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π';
        
        if (error.response?.status === 403) {
            errorMessage = '–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–±–±–∏';
        } else if (error.response?.data?.error) {
            errorMessage = error.response.data.error;
        } else if (error.message) {
            errorMessage = error.message;
        }
        
        setMessage(`${errorMessage}`);
    } finally {
        setLoading(false);
        setTimeout(() => setMessage(''), 5000);
    }
}, [id]);
```

2. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–ø –≤ `TournamentAdminPanel` (—Å—Ç—Ä–æ–∫–∞ ~1431):

```javascript
onResendLobbyInvites={handleResendLobbyInvites}
```

3. –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–∂–µ—Ç `ActiveLobbyWidget` –ø–æ—Å–ª–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞ (—Å—Ç—Ä–æ–∫–∞ ~700):

```javascript
{/* –í–∏–¥–∂–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏ */}
{user && <ActiveLobbyWidget tournamentId={id} user={user} />}
```

## üìä –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–£—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏–µ –ª–æ–±–±–∏**:
   - –õ–æ–±–±–∏ —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç —á–µ—Ä–µ–∑ 1 —á–∞—Å –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–æ–π—Ç–∏ –≤ —É—Å—Ç–∞—Ä–µ–≤—à–µ–µ –ª–æ–±–±–∏ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞
   - –í –≤–∏–¥–∂–µ—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

2. **–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π**:
   - –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–æ–±–±–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
   - –ö–Ω–æ–ø–∫–∞ "üì® –ü–µ—Ä–µ—Å–ª–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–æ–±–±–∏
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket + –ë–î

3. **–í–∏–¥–∂–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ª–æ–±–±–∏ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Ç—É—Ä–Ω–∏—Ä
   - –ö–Ω–æ–ø–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –≤—Ö–æ–¥–∞ –≤ –ª–æ–±–±–∏
   - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –ª–æ–±–±–∏ —É—Å—Ç–∞—Ä–µ–ª–æ

## üöÄ –î–µ–ø–ª–æ–π

```bash
# –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
git add .
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è –ª–æ–±–±–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π"
git push origin main

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@80.87.200.23
cd /var/www/1337community.com/
git pull origin main
pm2 restart 1337-backend
```

## ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- ‚úÖ –ù–µ—Ç –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–±–±–∏ - –æ–¥–Ω–æ –ª–æ–±–±–∏ –Ω–∞ –º–∞—Ç—á
- ‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ –º–æ–≥—É—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–æ–±–±–∏ —á–µ—Ä–µ–∑ –≤–∏–¥–∂–µ—Ç
- ‚úÖ –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –ø–µ—Ä–µ—Å–ª–∞—Ç—å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ –ø–æ—Ç–µ—Ä—è–ª —Å—Å—ã–ª–∫—É
- ‚úÖ –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ª–æ–±–±–∏ (> 1 —á–∞—Å) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- ‚úÖ –ú–∏–Ω–∏–º—É–º –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥–µ

