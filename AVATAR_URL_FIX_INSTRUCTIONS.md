# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å URL –∞–≤–∞—Ç–∞—Ä–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üö® –ü—Ä–æ–±–ª–µ–º–∞
–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞:
```
GET https://localhost:3000/uploads/avatars/1337-logo-chat.png net::ERR_CONNECTION_REFUSED
```

–≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL —Å `localhost:3000` –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞ `1337community.com`.

## üîç –ü—Ä–∏—á–∏–Ω–∞
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö** - –∞–≤–∞—Ç–∞—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å localhost URL
2. **–§—É–Ω–∫—Ü–∏—è ensureHttps –Ω–µ –∏—Å–ø—Ä–∞–≤–ª—è–ª–∞ localhost** - —Ç–æ–ª—å–∫–æ –∑–∞–º–µ–Ω—è–ª–∞ http –Ω–∞ https

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è ensureHttps
**–§–∞–π–ª:** `frontend/src/utils/userHelpers.js`

–¢–µ–ø–µ—Ä—å —Ñ—É–Ω–∫—Ü–∏—è:
- –ó–∞–º–µ–Ω—è–µ—Ç `http://` –Ω–∞ `https://`
- –í production –∑–∞–º–µ–Ω—è–µ—Ç `localhost:3000` –Ω–∞ `1337community.com`

```javascript
export const ensureHttps = (url) => {
  if (!url) return url;
  
  // –ó–∞–º–µ–Ω—è–µ–º http –Ω–∞ https
  let correctedUrl = url.replace(/^http:\/\//i, 'https://');
  
  // –í production –∑–∞–º–µ–Ω—è–µ–º localhost:3000 –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
  if (process.env.NODE_ENV === 'production' || window.location.hostname !== 'localhost') {
    correctedUrl = correctedUrl.replace(/^https?:\/\/localhost:3000/i, 'https://1337community.com');
  }
  
  return correctedUrl;
};
```

### 2. –£–ª—É—á—à–µ–Ω CSS –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤
**–§–∞–π–ª—ã:** `frontend/src/components/ChatWindow.css`, `frontend/src/components/ChatList.css`

–î–æ–±–∞–≤–ª–µ–Ω—ã —Å—Ç–∏–ª–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:
- `object-fit: cover` - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–ø–æ—Ä—Ü–∏–π
- `object-position: center` - —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `display: flex` –∏ `align-items: center` - —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `background-color: #222222` - —Ñ–æ–Ω –Ω–∞ —Å–ª—É—á–∞–π –∑–∞–≥—Ä—É–∑–∫–∏
- `flex-shrink: 0` - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Å–∂–∞—Ç–∏—è

### 3. –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è URL –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `fix_avatar_url_production.sh`

–°–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç URL –∞–≤–∞—Ç–∞—Ä–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å `localhost:3000` –Ω–∞ `1337community.com`.

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ VDS —Å–µ—Ä–≤–µ—Ä—É
ssh root@your-server-ip

# 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /var/www/1337community

# 3. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–¥ –∏–∑ GitHub
git pull origin main

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ URL
chmod +x fix_avatar_url_production.sh
./fix_avatar_url_production.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
sudo -u postgres psql your_database_name

# 2. –ò—Å–ø—Ä–∞–≤—å—Ç–µ URL –∞–≤–∞—Ç–∞—Ä–∞
UPDATE users 
SET avatar_url = 'https://1337community.com/uploads/avatars/1337-logo-chat.png',
    updated_at = NOW()
WHERE username = '1337community' 
  AND avatar_url LIKE '%localhost:3000%';

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
SELECT username, avatar_url FROM users WHERE username = '1337community';

# 4. –í—ã–π–¥–∏—Ç–µ –∏–∑ PostgreSQL
\q
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü–æ–ª–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
cd /var/www/1337community
chmod +x complete_avatar_fix.sh
./complete_avatar_fix.sh
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

### 1. –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```sql
SELECT username, avatar_url, updated_at 
FROM users 
WHERE username = '1337community';
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- `avatar_url`: `https://1337community.com/uploads/avatars/1337-logo-chat.png`
- `updated_at`: –Ω–µ–¥–∞–≤–Ω—è—è –¥–∞—Ç–∞

### 2. –í –±—Ä–∞—É–∑–µ—Ä–µ:
1. –û—Ç–∫—Ä–æ–π—Ç–µ https://1337community.com
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞ (Ctrl+F5)
3. –û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12)
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —á–∞—Ç
5. ‚úÖ **–í –∫–æ–Ω—Å–æ–ª–∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—à–∏–±–æ–∫ —Å localhost:3000**
6. ‚úÖ **–ê–≤–∞—Ç–∞—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Å https://1337community.com**

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ HTTP –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏:
```bash
curl -I https://1337community.com/uploads/avatars/1337-logo-chat.png
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `HTTP/1.1 200 OK`

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –§—É–Ω–∫—Ü–∏—è `ensureHttps` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç localhost URL –≤ production
- ‚úÖ URL –∞–≤–∞—Ç–∞—Ä–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω
- ‚úÖ CSS –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤
- ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–µ—Ç –æ—à–∏–±–æ–∫ —Å localhost:3000
- ‚úÖ –ê–≤–∞—Ç–∞—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìã –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. `fix_avatar_url_production.sh` - —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è URL –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ CSS —Ñ–∞–π–ª—ã –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤
3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `ensureHttps` –≤ `userHelpers.js`

---

**–î–∞—Ç–∞:** $(date +%Y-%m-%d)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–í—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ~5 –º–∏–Ω—É—Ç  
**–ê–≤—Ç–æ—Ä:** 1337 Community Team 