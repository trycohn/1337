-- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –≤—Å—Ç–∞–≤–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ON CONFLICT
-- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤–º–µ—Å—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ INSERT, –µ—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã

DO $$
DECLARE
    achievement_data RECORD;
    achievement_exists BOOLEAN;
BEGIN
    -- –¢—É—Ä–Ω–∏—Ä–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
    FOR achievement_data IN VALUES
        ('–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏', '–ü—Ä–∏–Ω—è–ª —É—á–∞—Å—Ç–∏–µ –≤ –ø–µ—Ä–≤–æ–º —Ç—É—Ä–Ω–∏—Ä–µ', 'üéØ', 'tournaments', 'common', 10, 'tournaments_participated', 1),
        ('–¢—É—Ä–Ω–∏—Ä–Ω—ã–π –±–æ–µ—Ü', '–ü—Ä–∏–Ω—è–ª —É—á–∞—Å—Ç–∏–µ –≤ 5 —Ç—É—Ä–Ω–∏—Ä–∞—Ö', '‚öîÔ∏è', 'tournaments', 'rare', 25, 'tournaments_participated', 5),
        ('–¢—É—Ä–Ω–∏—Ä–Ω—ã–π –≤–µ—Ç–µ—Ä–∞–Ω', '–ü—Ä–∏–Ω—è–ª —É—á–∞—Å—Ç–∏–µ –≤ 25 —Ç—É—Ä–Ω–∏—Ä–∞—Ö', 'üõ°Ô∏è', 'tournaments', 'epic', 50, 'tournaments_participated', 25),
        ('–ü–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞', '–í—ã–∏–≥—Ä–∞–ª –ø–µ—Ä–≤—ã–π —Ç—É—Ä–Ω–∏—Ä', 'üëë', 'tournaments', 'rare', 50, 'tournaments_won', 1),
        ('–ß–µ–º–ø–∏–æ–Ω', '–í—ã–∏–≥—Ä–∞–ª 5 —Ç—É—Ä–Ω–∏—Ä–æ–≤', 'üèÜ', 'tournaments', 'legendary', 100, 'tournaments_won', 5),
        
        -- –ò–≥—Ä–æ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        ('–î–µ–±—é—Ç–∞–Ω—Ç', '–°—ã–≥—Ä–∞–ª –ø–µ—Ä–≤—ã–π –º–∞—Ç—á', 'üéÆ', 'games', 'common', 5, 'matches_played', 1),
        ('–ê–∫—Ç–∏–≤–Ω—ã–π –∏–≥—Ä–æ–∫', '–°—ã–≥—Ä–∞–ª 50 –º–∞—Ç—á–µ–π', 'üéØ', 'games', 'rare', 30, 'matches_played', 50),
        ('–í–µ—Ç–µ—Ä–∞–Ω', '–°—ã–≥—Ä–∞–ª 200 –º–∞—Ç—á–µ–π', '‚≠ê', 'games', 'epic', 75, 'matches_played', 200),
        ('–ü–µ—Ä–≤–∞—è –ø–æ–±–µ–¥–∞ –≤ –º–∞—Ç—á–µ', '–í—ã–∏–≥—Ä–∞–ª –ø–µ—Ä–≤—ã–π –º–∞—Ç—á', '‚ú®', 'games', 'common', 15, 'matches_won', 1),
        ('–ú–∞—Å—Ç–µ—Ä –ø–æ–±–µ–¥', '–í—ã–∏–≥—Ä–∞–ª 100 –º–∞—Ç—á–µ–π', 'üî•', 'games', 'legendary', 150, 'matches_won', 100),
        
        -- –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        ('–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π', '–î–æ–±–∞–≤–∏–ª –ø–µ—Ä–≤–æ–≥–æ –¥—Ä—É–≥–∞', 'üë•', 'social', 'common', 10, 'friends_count', 1),
        ('–ü–æ–ø—É–ª—è—Ä–Ω—ã–π', '–ò–º–µ–µ—Ç 10 –¥—Ä—É–∑–µ–π', 'ü§ù', 'social', 'rare', 25, 'friends_count', 10),
        ('–ó–≤–µ–∑–¥–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞', '–ò–º–µ–µ—Ç 50 –¥—Ä—É–∑–µ–π', 'üåü', 'social', 'epic', 75, 'friends_count', 50),
        
        -- –°–µ—Ä–∏–π–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        ('–£–¥–∞—á–Ω–∞—è —Å–µ—Ä–∏—è', '–í—ã–∏–≥—Ä–∞–ª 3 –º–∞—Ç—á–∞ –ø–æ–¥—Ä—è–¥', 'üìà', 'streaks', 'rare', 30, 'win_streak', 3),
        ('–î–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ', '–í—ã–∏–≥—Ä–∞–ª 10 –º–∞—Ç—á–µ–π –ø–æ–¥—Ä—è–¥', 'üí™', 'streaks', 'legendary', 100, 'win_streak', 10),
        ('–ù–µ–ø–æ–±–µ–¥–∏–º—ã–π', '–í—ã–∏–≥—Ä–∞–ª 25 –º–∞—Ç—á–µ–π –ø–æ–¥—Ä—è–¥', 'üëë', 'streaks', 'mythical', 250, 'win_streak', 25),
        
        -- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        ('–°–Ω–∞–π–ø–µ—Ä', '–î–æ—Å—Ç–∏–≥ 80% –≤–∏–Ω—Ä–µ–π—Ç–∞ (–º–∏–Ω–∏–º—É–º 20 –∏–≥—Ä)', 'üéØ', 'performance', 'epic', 100, 'winrate_threshold', 80),
        ('–õ–µ–≥–µ–Ω–¥–∞', '–î–æ—Å—Ç–∏–≥ 90% –≤–∏–Ω—Ä–µ–π—Ç–∞ (–º–∏–Ω–∏–º—É–º 50 –∏–≥—Ä)', '‚ö°', 'performance', 'mythical', 200, 'winrate_threshold', 90),
        
        -- –û—Å–æ–±—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
        ('–†–∞–Ω–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å', '–û–¥–∏–Ω –∏–∑ –ø–µ—Ä–≤—ã—Ö 1000 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π', 'üåü', 'special', 'legendary', 500, 'early_user', 1000),
        ('–ì–æ–¥ —Å –Ω–∞–º–∏', '–ê–∫—Ç–∏–≤–µ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞', 'üéÇ', 'special', 'epic', 100, 'active_days', 365)
    LOOP
        -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º
        SELECT EXISTS(SELECT 1 FROM achievements WHERE title = achievement_data.column1) INTO achievement_exists;
        
        IF NOT achievement_exists THEN
            INSERT INTO achievements (title, description, icon, category, rarity, points, condition_type, condition_value)
            VALUES (achievement_data.column1, achievement_data.column2, achievement_data.column3, 
                   achievement_data.column4, achievement_data.column5, achievement_data.column6,
                   achievement_data.column7, achievement_data.column8);
            RAISE NOTICE '–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ: %', achievement_data.column1;
        ELSE
            RAISE NOTICE '–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: %', achievement_data.column1;
        END IF;
    END LOOP;
    
    RAISE NOTICE '‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω—ã';
END $$; 